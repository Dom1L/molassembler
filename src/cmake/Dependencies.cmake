find_package(Eigen3 3.1.1 REQUIRED)
set(Boost_USE_STATIC_LIBS OFF)
set(Boost_USE_MULTITHREADED ON)

find_package(Boost
  COMPONENTS regex unit_test_framework program_options filesystem system
)

include(FindMKL)
if(MKL_FOUND)
  set(EXTERNAL_LINALG_FOUND TRUE)
  set(EXTERNAL_LINALG_LIBRARIES ${MKL_LIBRARIES})
  set(EXTERNAL_LINALG_INCLUDE_DIRS ${MKL_INCLUDE_DIRS})
  set(EIGEN_LINALG_DEFINES EIGEN_USE_MKL_ALL)
else()
  include(FindBLAS)
  find_package(BLAS QUIET)
  if(BLAS_FOUND)
    set(EXTERNAL_LINALG_FOUND TRUE)
    list(APPEND EXTERNAL_LINALG_LIBRARIES ${BLAS_LIBRARIES})
    list(APPEND EIGEN_LINALG_DEFINES EIGEN_USE_BLAS)
  endif()
  include(FindLAPACK)
  find_package(LAPACK QUIET)
  if(LAPACK_FOUND)
    set(EXTERNAL_LINALG_FOUND TRUE)
    list(APPEND EXTERNAL_LINALG_LIBRARIES ${LAPACK_LIBRARIES})
    list(APPEND EIGEN_LINALG_DEFINES EIGEN_USE_LAPACK)
  endif()
endif()
