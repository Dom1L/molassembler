TODO
----

- ligand loss algorithm is not complete, neither in dynamic or constexpr
  contexts
